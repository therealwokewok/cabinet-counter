"use client";
import { jsx as _jsx } from "react/jsx-runtime";
import React from "react";
import DropdownMenu from "../DropdownMenu/index.js";
import useScrollLock from "../../hooks/useScrollLock.js";
import s from "./ContextMenu.module.css";
import useHandlerRef from "../../hooks/useHandlerRef.js";
const ContextMenu = (props) => {
    const { position = "end-top", onOpen, onClose, ...dropdownMenuProps } = props;
    const [coordinates, setCoordinates] = React.useState();
    const originRef = React.useRef(null);
    const { lockScroll, unlockScroll } = useScrollLock({ originRef });
    const onOpenRef = useHandlerRef(onOpen);
    React.useEffect(() => {
        const originEl = originRef.current;
        if (!originEl)
            return;
        const handleContextMenu = (e) => {
            e.preventDefault();
            setCoordinates({ x: e.clientX, y: e.clientY });
            lockScroll();
            onOpenRef.current?.();
        };
        originEl.addEventListener("contextmenu", handleContextMenu);
        return () => originEl.removeEventListener("contextmenu", handleContextMenu);
    }, [lockScroll, onOpenRef]);
    React.useEffect(() => {
        return () => unlockScroll();
    }, [unlockScroll]);
    return (_jsx("div", { className: s.root, ref: originRef, children: _jsx(DropdownMenu, { ...dropdownMenuProps, position: position, originCoordinates: coordinates, active: !!coordinates, onClose: (args) => {
                setCoordinates(undefined);
                unlockScroll();
                onClose?.(args);
            } }) }));
};
ContextMenu.displayName = "ContextMenu";
export default ContextMenu;
